<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ­Ø¯ÙŠ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø§Ù„Ù…Ø«ÙŠØ±</title>
    <style>
        /* Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ø§Ù…Ø© */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            transition: background 1s ease, color 0.5s ease;
            overflow: hidden;
        }

        .container {
            background: rgba(255, 255, 255, 0.9);
            padding: 2rem;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            width: 90%;
            max-width: 600px;
            text-align: center;
            transition: transform 0.3s ease;
            position: relative;
            z-index: 10;
            display: none; /* Ù…Ø®ÙÙŠ ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Ø­ØªÙ‰ ÙŠØªÙ… Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ø¨Ø¯Ø¡ */
        }

        /* Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© */
        #start-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            color: white;
            text-align: center;
        }

        #start-overlay h1 { font-size: 3rem; margin-bottom: 20px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
        
        .start-btn {
            padding: 20px 50px;
            font-size: 1.5rem;
            background: #ffeb3b;
            color: #333;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transition: transform 0.2s;
            animation: pulse 2s infinite;
        }
        .start-btn:hover { transform: scale(1.1); }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 235, 59, 0.7); }
            70% { box-shadow: 0 0 0 20px rgba(255, 235, 59, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 235, 59, 0); }
        }

        h1 { margin-bottom: 10px; }
        p { font-size: 1.2rem; margin-bottom: 20px; }
        
        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… */
        .progress-container {
            width: 100%;
            background-color: #ddd;
            border-radius: 10px;
            margin-bottom: 20px;
            height: 10px;
            overflow: hidden;
        }
        .progress-bar {
            height: 100%;
            width: 0%;
            transition: width 0.5s ease;
        }

        /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙˆØ§Ù„Ø®ÙŠØ§Ø±Ø§Øª */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }

        .btn {
            padding: 15px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: transform 0.2s, background 0.3s;
            background-color: #f0f0f0;
            color: #333;
        }

        .btn:hover { transform: scale(1.05); }
        .btn:active { transform: scale(0.95); }

        .btn.correct { background-color: #4CAF50; color: white; }
        .btn.wrong { background-color: #f44336; color: white; }

        /* Ø²Ø± Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„ØµÙˆØª */
        #music-control {
            position: absolute;
            top: 10px;
            left: 10px;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            opacity: 0.7;
        }

        /* --- ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª (Themes) --- */
        /* Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 1: Ù‡Ø§Ø¯Ø¦ (Calm) */
        body.level-1 { background: linear-gradient(135deg, #e0f7fa 0%, #b2dfdb 100%); color: #006064; }
        body.level-1 .progress-bar { background-color: #00bcd4; }
        body.level-1 .btn:hover { background-color: #b2ebf2; }

        /* Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 2: Ø³Ø¹Ø§Ø¯Ø© ÙˆÙÙˆØ² (Happy) */
        body.level-2 { background: linear-gradient(135deg, #fff9c4 0%, #ffcc80 100%); color: #e65100; }
        body.level-2 .container { border: 4px solid #ffeb3b; }
        body.level-2 .progress-bar { background-color: #ff9800; }
        body.level-2 .btn:hover { background-color: #ffe0b2; }

        /* Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 3: Ø­Ù…Ø§Ø³ ÙˆØµØ¹ÙˆØ¨Ø© (Intense) */
        body.level-3 { background: linear-gradient(135deg, #212121 0%, #b71c1c 100%); color: #ffebee; }
        body.level-3 .container { background: rgba(30, 30, 30, 0.95); color: #ff5252; border: 2px solid #ff1744; box-shadow: 0 0 20px #ff1744; }
        body.level-3 .btn { background-color: #424242; color: #fff; }
        body.level-3 .progress-bar { background-color: #ff1744; box-shadow: 0 0 10px #ff1744; }
        body.level-3 .btn:hover { background-color: #616161; border: 1px solid #ff1744; }

        #result-screen { display: none; }
    </style>
</head>
<body class="level-1">

    <audio id="bg-music" loop>
        Ù…ØªØµÙØ­Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª.
    </audio>

    <div id="start-overlay">
        <h1>ØªØ­Ø¯ÙŠ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</h1>
        <p>30 Ø³Ø¤Ø§Ù„Ø§Ù‹ØŒ 3 Ù…Ø³ØªÙˆÙŠØ§Øª Ù…Ù† Ø§Ù„Ø­Ù…Ø§Ø³!</p>
        <button class="start-btn" onclick="startGame()">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ­Ø¯ÙŠ ğŸµ</button>
    </div>

    <div class="container" id="game-container">
        <button id="music-control" onclick="toggleMusic()">ğŸ”Š</button>
        <div id="quiz-screen">
            <h2 id="level-title">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£ÙˆÙ„</h2>
            <div class="progress-container">
                <div class="progress-bar" id="progress-bar"></div>
            </div>
            <h1 id="question-text">...</h1>
            <div class="options-grid" id="options-container"></div>
            <p id="feedback" style="height: 20px; margin-top: 15px; font-weight: bold;"></p>
        </div>

        <div id="result-screen">
            <h1>Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ØªØ­Ø¯ÙŠ!</h1>
            <p>Ù†ØªÙŠØ¬ØªÙƒ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©:</p>
            <h2 id="final-score" style="font-size: 3rem;">0 / 30</h2>
            <button class="btn" onclick="location.reload()" style="background:#2196F3; color:white; width:100%;">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©</button>
        </div>
    </div>

    <script>
        // --- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ (ØªØ£ÙƒØ¯ Ù…Ù† ØªØ³Ù…ÙŠØ© Ù…Ù„ÙØ§ØªÙƒ Ù‡ÙƒØ°Ø§) ---
        const musicSources = {
            1: 'music_level1.mp3', // Ù‡Ø§Ø¯Ø¦
            2: 'music_level2.mp3', // Ø­Ù…Ø§Ø³ Ù…ØªÙˆØ³Ø·
            3: 'music_level3.mp3'  // Ø­Ù…Ø§Ø³ Ø´Ø¯ÙŠØ¯
        };

        // --- Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø¦Ù„Ø© (30 Ø³Ø¤Ø§Ù„) ---
        const questions = [
            // === Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 1: Ø³Ù‡Ù„ (1-10) ===
            { q: "What is the opposite of 'Big'?", options: ["Small", "Tall", "Huge", "Wide"], answer: 0 },
            { q: "I ___ a student.", options: ["is", "are", "am", "be"], answer: 2 },
            { q: "Choose the correct spelling:", options: ["Appel", "Apple", "Apel", "Aplle"], answer: 1 },
            { q: "Sun is to Day as Moon is to ___", options: ["Light", "Star", "Night", "Sky"], answer: 2 },
            { q: "She ___ to school every day.", options: ["go", "goes", "going", "gone"], answer: 1 },
            { q: "What color is a banana?", options: ["Red", "Blue", "Yellow", "Purple"], answer: 2 },
            { q: "We have two ___.", options: ["foot", "foots", "feet", "feets"], answer: 2 },
            { q: "___ is your name?", options: ["Who", "What", "Where", "Why"], answer: 1 },
            { q: "Select the verb:", options: ["Happy", "Run", "Blue", "Table"], answer: 1 },
            { q: "Yesterday, I ___ football.", options: ["play", "played", "playing", "plays"], answer: 1 },
            // === Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 2: Ù…ØªÙˆØ³Ø· (11-20) ===
            { q: "I have lived here ___ 2010.", options: ["for", "since", "ago", "in"], answer: 1 },
            { q: "If it rains, we ___ inside.", options: ["stay", "will stay", "stayed", "staying"], answer: 1 },
            { q: "The book was written ___ JK Rowling.", options: ["with", "from", "by", "of"], answer: 2 },
            { q: "He is the ___ runner in the team.", options: ["fast", "faster", "fastest", "fastly"], answer: 2 },
            { q: "I enjoy ___ movies.", options: ["watch", "to watch", "watching", "watched"], answer: 2 },
            { q: "She didn't ___ to the party.", options: ["come", "came", "comes", "coming"], answer: 0 },
            { q: "Would you like ___ coffee?", options: ["some", "any", "a", "many"], answer: 0 },
            { q: "I'm interested ___ learning English.", options: ["on", "at", "in", "for"], answer: 2 },
            { q: "Could you please turn ___ the light?", options: ["out", "in", "off", "up"], answer: 2 },
            { q: "They ___ dinner when I arrived.", options: ["eat", "ate", "were eating", "have eaten"], answer: 2 },
            // === Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 3: ØµØ¹Ø¨ (21-30) ===
            { q: "The meeting was ___ due to the storm.", options: ["called off", "called in", "called out", "called up"], answer: 0 },
            { q: "By next year, I ___ my degree.", options: ["finish", "will finish", "will have finished", "am finishing"], answer: 2 },
            { q: "Rarely ___ such a beautiful sunset.", options: ["I have seen", "have I seen", "I saw", "seen I have"], answer: 1 },
            { q: "He is accused ___ stealing the money.", options: ["of", "with", "for", "about"], answer: 0 },
            { q: "Don't count your chickens before they ___.", options: ["born", "hatch", "lay", "die"], answer: 1 },
            { q: "The synonym of 'Obstinate' is:", options: ["Flexible", "Stubborn", "Obedient", "Kind"], answer: 1 },
            { q: "Had I known, I ___ you.", options: ["would help", "will help", "would have helped", "helped"], answer: 2 },
            { q: "It's high time we ___ home.", options: ["go", "went", "gone", "going"], answer: 1 },
            { q: "___ strictly speaking, spiders are not insects.", options: ["Although", "However", "Despite", "But"], answer: 1 },
            { q: "The intricate plot was hard to ___.", options: ["figure out", "figure in", "figure off", "figure away"], answer: 0 }
        ];

        let currentQuestion = 0;
        let score = 0;
        let currentLevel = 1;

        const questionText = document.getElementById("question-text");
        const optionsContainer = document.getElementById("options-container");
        const progressBar = document.getElementById("progress-bar");
        const levelTitle = document.getElementById("level-title");
        const feedback = document.getElementById("feedback");
        const body = document.body;
        const bgMusic = document.getElementById("bg-music");
        const musicBtn = document.getElementById("music-control");
        let isPlaying = false; 

        // Ø¯Ø§Ù„Ø© ØªØºÙŠÙŠØ± Ù…ØµØ¯Ø± Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ ÙˆØªØ´ØºÙŠÙ„Ù‡Ø§
        function switchMusic(level) {
            const newMusicSrc = musicSources[level];
            
            // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù‡ÙŠ Ù†ÙØ³Ù‡Ø§ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©ØŒ Ù„Ø§ ØªÙØ¹Ù„ Ø´ÙŠØ¦Ø§Ù‹
            if (bgMusic.src.includes(newMusicSrc) && isPlaying) {
                return;
            }

            // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ø§Ù„Ø­Ø§Ù„ÙŠØ©
            bgMusic.pause();
            
            // ØªØºÙŠÙŠØ± Ù…ØµØ¯Ø± Ø§Ù„ØµÙˆØª
            bgMusic.src = newMusicSrc;
            bgMusic.load(); // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ØµØ¯Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯
            
            // ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© (Ø¨Ø´Ø±Ø· Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù‚Ø¯ Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©)
            if (isPlaying) {
                bgMusic.volume = 0.3; // Ø§Ù„ØµÙˆØª Ù…Ù†Ø®ÙØ¶ Ù‚Ù„ÙŠÙ„Ø§Ù‹
                bgMusic.play().catch(e => console.log("Music play blocked: " + e));
                musicBtn.textContent = "ğŸ”Š";
            } else {
                 musicBtn.textContent = "ğŸ”‡";
            }
        }

        // Ø¯Ø§Ù„Ø© Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø© (Ù„Ø­Ù„ Ù…Ø´ÙƒÙ„Ø© Ø§Ù„ØµÙˆØª Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ)
        function startGame() {
            document.getElementById("start-overlay").style.display = "none";
            document.getElementById("game-container").style.display = "block";
            isPlaying = true; // Ù†Ø¤ÙƒØ¯ Ø£Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø³Ù…Ø­ Ø¨Ø§Ù„ØªØ´ØºÙŠÙ„
            
            // ØªØ´ØºÙŠÙ„ Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£ÙˆÙ„
            switchMusic(1);

            loadQuestion();
        }

        // Ø¯Ø§Ù„Ø© ÙƒØªÙ…/ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª
        function toggleMusic() {
            if (bgMusic.paused) {
                bgMusic.play();
                musicBtn.textContent = "ğŸ”Š";
                isPlaying = true;
            } else {
                bgMusic.pause();
                musicBtn.textContent = "ğŸ”‡";
                isPlaying = false;
            }
        }

        function loadQuestion() {
            if (currentQuestion >= questions.length) {
                showResults();
                return;
            }

            updateLevelDesign();

            const qData = questions[currentQuestion];
            questionText.textContent = qData.q;
            optionsContainer.innerHTML = "";
            feedback.textContent = "";

            const progress = ((currentQuestion) / questions.length) * 100;
            progressBar.style.width = `${progress}%`;

            qData.options.forEach((opt, index) => {
                const btn = document.createElement("button");
                btn.className = "btn";
                btn.textContent = opt;
                btn.onclick = () => checkAnswer(index, btn);
                optionsContainer.appendChild(btn);
            });
        }

        function updateLevelDesign() {
            let nextLevel = 1;
            if (currentQuestion < 10) {
                nextLevel = 1;
                levelTitle.textContent = "Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 1: Ø§Ø³ØªØ±Ø®Ù ÙˆØ£Ø¬Ø¨ (Ù‡Ø§Ø¯Ø¦)";
            } else if (currentQuestion < 20) {
                nextLevel = 2;
                levelTitle.textContent = "Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 2: Ø´Ø¹ÙˆØ± Ø§Ù„ÙÙˆØ²! (Ø­Ù…Ø§Ø³ Ù…ØªÙˆØ³Ø·)";
            } else {
                nextLevel = 3;
                levelTitle.textContent = "Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 3: Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø®Ø·Ø±! (Ø­Ù…Ø§Ø³ Ø´Ø¯ÙŠØ¯)";
            }

            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØµÙ…ÙŠÙ… (Ø§Ù„Ø®Ù„ÙÙŠØ© ÙˆØ§Ù„Ø£Ù„ÙˆØ§Ù†)
            body.classList.remove("level-1", "level-2", "level-3");
            body.classList.add(`level-${nextLevel}`);

            // ØªØºÙŠÙŠØ± Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ø¥Ø°Ø§ Ø§Ù†ØªÙ‚Ù„Ù†Ø§ Ù„Ù…Ø³ØªÙˆÙ‰ Ø¬Ø¯ÙŠØ¯
            if (nextLevel !== currentLevel) {
                currentLevel = nextLevel;
                switchMusic(currentLevel);
            }
        }

        function checkAnswer(selectedIndex, btnElement) {
            const allBtns = optionsContainer.children;
            for (let btn of allBtns) { btn.disabled = true; }

            const correctIndex = questions[currentQuestion].answer;

            if (selectedIndex === correctIndex) {
                btnElement.classList.add("correct");
                score++;
                feedback.textContent = "ØµØ­ÙŠØ­! âœ…";
                feedback.style.color = currentQuestion >= 20 ? "#4CAF50" : "green";
            } else {
                btnElement.classList.add("wrong");
                allBtns[correctIndex].classList.add("correct");
                feedback.textContent = "Ø®Ø§Ø·Ø¦! âŒ";
                feedback.style.color = "red";
            }

            setTimeout(() => {
                currentQuestion++;
                loadQuestion();
            }, 1200);
        }

        function showResults() {
            bgMusic.pause(); // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‡Ø§ÙŠØ©
            document.getElementById("quiz-screen").style.display = "none";
            document.getElementById("result-screen").style.display = "block";
            document.getElementById("final-score").textContent = `${score} / ${questions.length}`;
            body.className = "level-2"; 
            levelTitle.textContent = "Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©";
        }
    </script>
</body>
</html>